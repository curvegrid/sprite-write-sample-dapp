const path = require('path');

const doSleep = false;
const sleepTime = 3000;

function sleep(ms) {
  console.log(`\nSleeping for ${ms}ms...\n`);
  return new Promise((resolve) => setTimeout(resolve, ms));
}

// Retrieve and process the config file
const CONFIG_FILE = path.join(__dirname, `../deployment-config.${process.env.HARDHAT_NETWORK || 'development'}`);
const { config } = require(CONFIG_FILE);
const hsmAddress = config.hsmAddress;

const sprites = [
  // sun and field
  '000000000000000000000b0b0b0b0b0b00000000000b0b0b0b000b0b0b0b0b0b000000000000000000000b0b0b0b0b0b00000000000000000b000b0b0b0b0b0b00000000000000000b00000b0b0b0b0b000000000000000b00000b0000000b0b000000000000000000000b0000000000000000000000000000000b0000000b00000000000000000000000b0000000b0000000000000000000000000000000b0000000e000000000e000000000000000000000e000e0e000e00000e0e0e0000002a2a0e2a2a0e2a0e2a2a0e2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a0e2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a',

  // TNT
  '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000505050505050505050505050500000005050505050505050505050505000000050505050505050505050505050000000505050505050505050505050500000000000000000000000000000000000000010101000101000001000101010000000001000001010100010000010000000000010000010001010100000100000000000100000100000101000001000000000505050505050505050505050500000005050505050505050505050505000000050505050505050505050505050000000505050505050505050505050500',

  // Curvegrid logo
  '00000000000000000000000000000000000000000000000000000000000000000000000005050505050505000000000000000005050000000000050000000000000005050000000000000000000000000000050000000000000000050500000000000500000000000000000505000000000005000000000000000000000000000000050000000000000000000000000000000500000000000000000005000000000005050000000000000000050000000000000505000000000000000500000000000000050500000000000505000000000000000005050505050505000000000000000000000000000000000000000000000000000000000000000000000000',

  // blue smiley face
  '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0d00000000000d0d000000000000000d0d00000000000d0d000000000000000000000000000000000000000000000000000000000000000000000000000d000000000000000000000d0d0000000d00000000000000000000000d0000000d00000000000000000000000d0000000d00000000000000000000000d0000000d0d0000000000000000000d0d000000000d0d000000000000000d0d0000000000000d0d0d0d0000000d0d000000000000000000000d0d0d0d0d00000000',

  // fox
  '00000000000000000000000000000000000000000000000000000000000000000000000001000000000000000100000000000001000100000000000100010000000000010011010000000111000100000000000100111101010111110001000000000001000101111111010100010000000000010111111111111111010100000000000111111111111111111101000000000001110111111111110111010000000001111101110101011101111101000000011111111100010011111111010000011111111100000000001111111101000001010000000000000000000101000000000001010101010101010100000000000000000000000000000000000000',

  // rock on!
  '00000101000000000000000101000000000110100100000000000110100100000001101001000000000001101001000000011010010000000000011010010000000110100101010001010110100100000001101001101001101001101001000000011010011010011010011010010000000110100110100110100110100100000001101001101001010101010101000000011010100101101010101010100100000110101010011010101010101001000001101010101001010110101010010000000110101010101010101010100100000001101010101010101010100100000000000110101010101010100100000000000000010101010101010100000000',

  // heart
  '00000000000000000000000000000000000000000000000000000000000000000000010101010100000101010101000000011515151501000001151515150100000115000015150101151515151501000001150015151515151515151515010000011515151515151515151515150100000115151515151515151515151501000001011515151515151515151501010000000101151515151515151501010000000000010115151515151501010000000000000001011515151501010000000000000000000101151501010000000000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000',
];

async function main() {
  const accounts = await hre.ethers.getSigners();
  const deployer = accounts[0];

  const spriteWrite = await hre.mbDeployer.deploy(deployer, 'SpriteWrite', [], {
    addressLabel: 'sprite_write',
    contractLabel: 'sprite_write',
  });

  console.log(`Deployed SpriteWrite.sol to ${spriteWrite.mbAddress.address}`);

  await spriteWrite.contract.grantRole(spriteWrite.contract.MINTER_ROLE(), hsmAddress);

  // Mint some sprites
  for (let i = 0; i < sprites.length; i++) {
    const sprite = sprites[i];
    await spriteWrite.contract.safeMint(sprite, deployer.address);
    if (doSleep) await sleep(sleepTime);
  }

  if (doSleep) await sleep(sleepTime);
}

// We recommend this pattern to be able to use async/await everywhere
// and properly handle errors.
main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
  });
